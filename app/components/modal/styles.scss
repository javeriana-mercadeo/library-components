@use '@styles/autoload' as *;

// ============================================
// MODAL COMPONENT - Sistema de modales reutilizables
// ============================================

// Variables locales SCSS del componente
$modal-overlay-bg-opacity: 0.65;
$modal-overlay-bg-edit-opacity: 0.3;
$modal-overlay-blur: 10px;
$modal-z-index: 10001;
$modal-close-btn-z-index: 10002;
$modal-close-btn-size: 35px;
$modal-close-btn-size-tablet: 40px;
$modal-animation-offset: -16px;
$modal-timing-function: cubic-bezier(0.2, 0, 0.2, 1);

// Tamaños de modal
$modal-width-sm: 450px;
$modal-width-md: 600px;
$modal-width-lg: 900px;
$modal-width-xl: 1200px;

@mixin modal {
  // ==========================================
  // OVERLAY DEL MODAL
  // ==========================================
  .puj-modal-overlay {
    box-sizing: border-box;
    position: fixed;
    inset: 0;
    display: none;
    justify-content: center;
    align-items: center;
    padding: 0;
    background-color: rgba(34, 39, 43, $modal-overlay-bg-opacity);
    backdrop-filter: blur($modal-overlay-blur);
    box-shadow: var(--shadow-md);
    z-index: $modal-z-index;
    opacity: 0;
    transition: opacity var(--transition) $modal-timing-function;

    &.active {
      opacity: 1;

      .puj-modal-content {
        transform: translateY(0);
        opacity: 1;
      }
    }

    &.puj-modal-overlay-top {
      align-items: flex-start;

      @include responsive($breakpoint-sm) {
        padding-top: var(--spacing-2xl);
      }
    }

    @include responsive($breakpoint-sm) {
      padding: var(--spacing-md);
    }

    @include liferay-edit-mode {
      position: initial !important;
      display: flex !important;
      opacity: 1 !important;
      transform: none !important;
      background-color: rgba(var(--neutral-100-rgb), $modal-overlay-bg-edit-opacity);
    }
  }

  // ==========================================
  // CONTENIDO DEL MODAL
  // ==========================================
  .puj-modal-content {
    box-sizing: border-box;
    position: relative;
    display: flex;
    flex-direction: column;
    width: 100%;
    max-width: 100vw;
    max-height: calc(100vh - var(--spacing-lg));
    overflow: hidden;
    border-radius: var(--border-radius-lg);
    background-color: var(--neutral-1000);
    color: var(--neutral-100);
    box-shadow: var(--shadow-lg);
    margin: var(--spacing-sm);
    padding: var(--spacing-md);
    transform: translateY($modal-animation-offset);
    opacity: 0;
    transition:
      transform var(--transition) $modal-timing-function,
      opacity var(--transition) $modal-timing-function;

    @include responsive($breakpoint-sm) {
      max-width: $modal-width-md;
      max-height: 90vh;
      border-radius: var(--border-radius-xl);
    }

    // Variantes de tamaño
    &.puj-modal-content-sm {
      @include responsive($breakpoint-sm) {
        max-width: $modal-width-sm;
      }
    }

    &.puj-modal-content-md {
      @include responsive($breakpoint-sm) {
        max-width: $modal-width-md;
      }
    }

    &.puj-modal-content-lg {
      @include responsive($breakpoint-sm) {
        max-width: $modal-width-lg;
      }
    }

    &.puj-modal-content-xl {
      @include responsive($breakpoint-sm) {
        max-width: $modal-width-xl;
      }
    }

    &.puj-modal-content-full {
      max-width: 95vw;
      max-height: 95vh;
    }

    @include liferay-edit-mode {
      opacity: 1 !important;
      transform: none !important;
      position: relative !important;
    }

    @include dark-theme {
      background-color: var(--neutral-900);
      color: var(--neutral-200);
    }
  }

  // ==========================================
  // BOTÓN DE CERRAR
  // ==========================================
  .btn.puj-modal-close-btn {
    position: relative;
    align-self: flex-end;
    border-radius: 50%;
    flex-shrink: 0;
  }

  // ==========================================
  // CUERPO DEL MODAL
  // ==========================================
  .puj-modal-body {
    box-sizing: border-box;
    width: 100%;
    flex: 1;
    padding: var(--spacing-sm);
    padding-right: var(--spacing-md);
    margin-right: var(--spacing-xs);

    // Estilos de scrollbar personalizados
    scrollbar-width: thin;
    scrollbar-color: var(--primary) transparent;
    scrollbar-gutter: stable;

    &::-webkit-scrollbar {
      width: 8px;
    }

    &::-webkit-scrollbar-track {
      background: rgba(var(--neutral-100-rgb), 0.1);
      border-radius: var(--border-radius-full);
      margin: var(--spacing-xs) 0;
    }

    &::-webkit-scrollbar-thumb {
      background-color: var(--primary);
      border-radius: var(--border-radius-full);

      &:hover {
        background-color: var(--primary-900);
      }
    }
  }

  // ==========================================
  // UTILIDADES GLOBALES
  // ==========================================

  // Prevenir scroll del body cuando hay modal activo
  body:has(.puj-modal-overlay.active) {
    overflow: hidden;
  }

  // Editable de Liferay
  .page-editor__editable {
    margin: 0;
  }
}
