@use 'sass:map';
@use 'sass:meta';
@use '@styles/autoload' as *;

@mixin paragraph {
  // Clase base común para todos los párrafos
  .paragraph {
    display: block;
    margin: 0;
    font-family: var(--font-family);
    line-height: 1.6;
    transition: all 0.2s ease-in-out;

    // ==========================================
    // TAMAÑOS DE PÁRRAFO
    // ==========================================
    &.paragraph-xs {
      font-size: var(--font-size-xs);
      margin-bottom: var(--spacing-xs);
      line-height: 1;
<<<<<<< HEAD
=======

      .lead {
        font-size: var(--font-size-xs);
        line-height: 1;
      }
>>>>>>> 2605cab52aa8312d63618e4bc012d1168c315cb3
    }

    &.paragraph-sm {
      font-size: var(--font-size-small);
      margin-bottom: var(--spacing-sm);
      line-height: 1.2;
<<<<<<< HEAD
=======

      .lead {
        font-size: var(--font-size-small);
        line-height: 1.2;
      }
>>>>>>> 2605cab52aa8312d63618e4bc012d1168c315cb3
    }

    &.paragraph-md {
      font-size: var(--font-size-paragraph);
      margin-bottom: var(--spacing-md);
      line-height: 1.5;
<<<<<<< HEAD
=======

      .lead {
        font-size: var(--font-size-paragraph);
        line-height: 1.5;
      }
>>>>>>> 2605cab52aa8312d63618e4bc012d1168c315cb3
    }

    &.paragraph-lg {
      font-size: var(--font-size-caption);
      margin-bottom: var(--spacing-md);
      line-height: 1.6;
<<<<<<< HEAD
=======

      .lead {
        font-size: var(--font-size-caption);
        line-height: 1.6;
      }
>>>>>>> 2605cab52aa8312d63618e4bc012d1168c315cb3
    }

    &.paragraph-xl {
      font-size: var(--font-size-subtitle);
      margin-bottom: var(--spacing-lg);
      line-height: 1.8;
<<<<<<< HEAD
=======

      .lead {
        font-size: var(--font-size-subtitle);
        line-height: 1.8;
      }
>>>>>>> 2605cab52aa8312d63618e4bc012d1168c315cb3
    }

    // ==========================================
    // ALINEACIONES
    // ==========================================
    &.paragraph-left {
      text-align: left;
    }

    &.paragraph-center {
      text-align: center;
    }

    &.paragraph-right {
      text-align: right;
    }

    &.paragraph-justify {
      text-align: justify;
      text-justify: inter-word;
    }

    // ==========================================
    // PESOS DE FUENTE
    // ==========================================
    &.paragraph-light {
      font-weight: var(--font-weight-light);
    }

    &.paragraph-regular {
      font-weight: var(--font-weight-regular);
    }

    &.paragraph-medium {
      font-weight: var(--font-weight-medium);
    }

    &.paragraph-semibold {
      font-weight: 600;
    }

    &.paragraph-bold {
      font-weight: var(--font-weight-bold);
    }

    &.paragraph-extrabold {
      font-weight: 800;
    }

    // ==========================================
    // ELEMENTOS INTERNOS COMUNES
    // ==========================================
<<<<<<< HEAD
=======

    @include liferay-edit-mode {
      .lead {
        color: var(--primary);
        font-weight: bold;
      }
    }

>>>>>>> 2605cab52aa8312d63618e4bc012d1168c315cb3
    strong,
    b {
      font-weight: var(--font-weight-bold);
      color: inherit;
    }

    em,
    i {
      font-style: italic;
      color: inherit;
    }

    // ==========================================
    // ESTILOS PARA TEXTO ENRIQUECIDO DE LIFERAY
    // ==========================================

    // Listas ordenadas y no ordenadas
    ol,
    ul {
      margin: var(--spacing-sm) 0;
      padding-left: var(--spacing-lg);
      color: inherit;

      li {
        margin-bottom: var(--spacing-xs);
        line-height: 1.6;
        color: inherit;
        font-size: inherit;

        // Párrafos dentro de listas
        p {
          margin: 0;
          padding: 0;
          color: inherit;
          font-size: inherit;
          line-height: inherit;
        }

        // Espaciado entre elementos de lista
        &:last-child {
          margin-bottom: 0;
        }
      }
    }

    // Listas ordenadas - numeración personalizada
    ol {
      counter-reset: custom-counter;
      list-style: none;
      padding-left: var(--spacing-xl);

      li {
        counter-increment: custom-counter;
        position: relative;

        &::before {
          content: counter(custom-counter) '.';
          position: absolute;
          left: rem(-24px);
          top: 0;
          color: inherit;
          font-weight: var(--font-weight-bold);
          font-size: inherit;
        }
      }
    }

    // ==========================================
    // LISTAS NO ORDENADAS
    // ==========================================
    ul {
      list-style: none;
      padding-left: var(--spacing-xl);

      li {
        position: relative;

        // Viñeta por defecto
        &::before {
          content: '•';
          position: absolute;
          left: rem(-16px);
          top: 0;
          color: inherit;
          font-weight: var(--font-weight-bold);
          font-size: rem(18px);
          line-height: 1.2;
        }
      }

      // ==========================================
      // LISTAS CON ÍCONOS PHOSPHOR
      // ==========================================
      &.list-with-icons {
        padding-left: 0;

        li {
          display: flex;
          align-items: flex-start;
          gap: var(--spacing-sm);
          margin-bottom: var(--spacing-md);

          &::before {
            display: none; // Ocultar viñeta por defecto
          }

          i[class*='ph-'] {
            display: flex;
            align-items: center;
            justify-content: center;
            width: rem(32px);
            height: rem(32px);
            font-size: rem(24px);
            color: var(--primary-600);
            flex-shrink: 0;
            margin-top: rem(2px);

            @include dark-theme {
              color: var(--primary-500);
            }

            // Íconos específicos con colores
            &.ph-check-circle,
            &.ph-check {
              color: var(--success-600);

              @include dark-theme {
                color: var(--success-500);
              }
            }
          }
        }
      }
    }

    // ==========================================
    // TÍTULOS H3 DENTRO DEL PÁRRAFO
    // ==========================================
    h3 {
      font-size: var(--font-size-caption);
      font-weight: var(--font-weight-bold);
      color: inherit;
      margin: var(--spacing-lg) 0 var(--spacing-sm) 0;
      line-height: 1.3;

      &:first-child {
        margin-top: var(--spacing-md);
      }

      strong {
        font-weight: inherit;
        color: inherit;
      }
    }

    // Texto pequeño
    .small,
    small {
      font-size: rem(12px);
      color: inherit;
      opacity: 0.8;
    }

    // Separadores horizontales
    hr {
      border: none;
      border-top: rem(1px) solid currentColor;
      opacity: 0.3;
      margin: var(--spacing-md) 0;
      width: 100%;
    }

    // Párrafos internos
    p {
      margin: var(--spacing-xs) 0;
      color: inherit;
      line-height: 1.6;

      &:first-child {
        margin-top: 0;
      }

      &:last-child {
        margin-bottom: 0;
      }

      // Párrafo vacío (solo <br>)
      &:empty {
        margin: 0;
        line-height: 1;
      }
    }

    // Saltos de línea
    br {
      margin: 0;
      line-height: 1;
    }

    // Enlaces dentro del párrafo
    a {
      color: inherit;
      text-decoration: underline;
      text-underline-offset: rem(2px);
      transition: all 0.2s ease;
      opacity: 1;

      &:hover {
        opacity: 0.8;
        text-decoration-thickness: rem(2px);
      }

      &:focus {
        outline: rem(2px) solid currentColor;
        outline-offset: rem(2px);
        border-radius: rem(2px);
        opacity: 0.9;
      }
    }

    // Código inline
    code {
      background: var(--neutral-800);
      color: inherit;
      padding: rem(2px) rem(4px);
      border-radius: rem(3px);
      font-family: 'Courier New', monospace;
      font-size: 0.9em;
      opacity: 0.9;
    }

    // Bloques de código
    pre {
      background: var(--neutral-900);
      border: rem(1px) solid var(--neutral-700);
      border-radius: rem(4px);
      padding: var(--spacing-sm);
      overflow-x: auto;
      margin: var(--spacing-sm) 0;

      code {
        background: none;
        padding: 0;
      }
    }

    // Citas
    blockquote {
      border-left: rem(4px) solid currentColor;
      padding-left: var(--spacing-md);
      margin: var(--spacing-md) 0;
      font-style: italic;
      opacity: 0.9;
    }

    // ==========================================
    // ESTADOS ESPECIALES
    // ==========================================
    // Párrafo clickeable
    &.paragraph-clickable {
      cursor: pointer;
      transition: all 0.2s ease;
      border-radius: rem(4px);
      padding: rem(2px) rem(4px);
      margin: rem(-2px) rem(-4px);

      &:hover {
        background: rgba(var(--primary-rgb), 0.05);
        transform: translateY(rem(-1px));
      }

      &:active {
        transform: translateY(0);
        background: rgba(var(--primary-rgb), 0.1);
      }

      &:focus {
        outline: rem(2px) solid var(--primary-400);
        outline-offset: rem(2px);
        background: rgba(var(--primary-rgb), 0.05);
      }
    }

    // Párrafo con truncado
    &.paragraph-truncate {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    // Párrafo con múltiples líneas (line-clamp)
    &.paragraph-clamp-2 {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    &.paragraph-clamp-3 {
      display: -webkit-box;
      -webkit-line-clamp: 3;
      line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    &.paragraph-clamp-4 {
      display: -webkit-box;
      -webkit-line-clamp: 4;
      line-clamp: 4;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    &.paragraph-clamp-5 {
      display: -webkit-box;
      -webkit-line-clamp: 5;
      line-clamp: 5;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    // ==========================================
    // RESPONSIVE PARA ELEMENTOS INTERNOS
    // ==========================================
    @media (max-width: $breakpoint-md) {
      ol,
      ul {
        padding-left: var(--spacing-md);
      }

      ol li::before {
        left: rem(-20px);
      }

      ul li::before {
        left: rem(-14px);
      }

      // Ajustes para listas con íconos en móvil
      ul.list-with-icons {
        li {
          gap: var(--spacing-xs);
          margin-bottom: var(--spacing-sm);

          i[class*='ph-'] {
            width: rem(28px);
            height: rem(28px);
            font-size: rem(20px);
          }
        }
      }

      h3 {
        font-size: var(--font-size-paragraph);
        margin: var(--spacing-md) 0 var(--spacing-xs) 0;
      }
    }
  }

  // ==========================================
  // MODIFICADORES DE TEXTO - ALTA ESPECIFICIDAD
  // ==========================================
  .paragraph {
    // Modificadores con !important para asegurar que no se sobrescriban
    &.paragraph-uppercase {
      text-transform: uppercase !important;
      letter-spacing: 0.05em !important;
    }

    &.paragraph-italic {
      font-style: italic !important;
    }

    &.paragraph-bold {
      font-weight: var(--font-weight-bold) !important;
    }

    // ==========================================
    // COMBINACIONES DE MODIFICADORES
    // ==========================================
    // Italic + Bold
    &.paragraph-italic.paragraph-bold {
      font-style: italic !important;
      font-weight: var(--font-weight-bold) !important;
    }

    // Uppercase + Bold
    &.paragraph-uppercase.paragraph-bold {
      text-transform: uppercase !important;
      letter-spacing: 0.05em !important;
      font-weight: var(--font-weight-bold) !important;
    }

    // Uppercase + Italic
    &.paragraph-uppercase.paragraph-italic {
      text-transform: uppercase !important;
      letter-spacing: 0.05em !important;
      font-style: italic !important;
    }

    // Triple combinación
    &.paragraph-uppercase.paragraph-italic.paragraph-bold {
      text-transform: uppercase !important;
      letter-spacing: 0.05em !important;
      font-style: italic !important;
      font-weight: var(--font-weight-bold) !important;
    }
  }

  // ==========================================
  // VARIACIONES ESPECIALES PARA NEUTRAL
  // ==========================================
  .paragraph-neutral {
    color: var(--neutral-100); // CORREGIDO: Usar 100 para máxima visibilidad

    // Preservar modificadores de texto
    &.paragraph-bold {
      font-weight: var(--font-weight-bold) !important;
    }

    &.paragraph-italic {
      font-style: italic !important;
    }

    &.paragraph-uppercase {
      text-transform: uppercase !important;
      letter-spacing: 0.05em !important;
    }

    @include dark-theme {
      color: var(--neutral-200); // En tema oscuro usar 200

      // Preservar modificadores en tema oscuro también
      &.paragraph-bold {
        font-weight: var(--font-weight-bold) !important;
      }

      &.paragraph-italic {
        font-style: italic !important;
      }

      &.paragraph-uppercase {
        text-transform: uppercase !important;
        letter-spacing: 0.05em !important;
      }
    }
  }

  @include colors-variants('paragraph', meta.get-mixin('paragraph-color-styles'));
}

// ===========================================
// MIXIN DE COLORES PARA PÁRRAFO
// ===========================================
@mixin paragraph-color-styles($color-values, $color-name) {
  // Variables CSS que se adaptan automáticamente por tema
  $color-200: var(--#{$color-name}-200);
  $color-300: var(--#{$color-name}-300);
  $color-400: var(--#{$color-name}-400);
  $color-500: var(--#{$color-name}-500);
  $color-600: var(--#{$color-name}-600);
  $color-700: var(--#{$color-name}-700);
  $color-800: var(--#{$color-name}-800);

  // Color principal del párrafo
  color: $color-500;

  // Estados para párrafos clickeables
  &.paragraph-clickable {
    &:hover {
      background: rgba(var(--#{$color-name}-rgb), 0.05);
    }

    &:active {
      background: rgba(var(--#{$color-name}-rgb), 0.1);
    }

    &:focus {
      outline-color: $color-400;
      background: rgba(var(--#{$color-name}-rgb), 0.05);
    }
  }

  // Preservar modificadores de texto
  &.paragraph-bold {
    font-weight: var(--font-weight-bold) !important;
  }

  &.paragraph-italic {
    font-style: italic !important;
  }

  &.paragraph-uppercase {
    text-transform: uppercase !important;
    letter-spacing: 0.05em !important;
  }

  // ==========================================
  // AJUSTES PARA MODO OSCURO
  // ==========================================
  @include dark-theme {
    color: $color-300;

    &.paragraph-clickable {
      &:hover {
        background: rgba(var(--#{$color-name}-rgb), 0.08);
      }

      &:active {
        background: rgba(var(--#{$color-name}-rgb), 0.15);
      }

      &:focus {
        background: rgba(var(--#{$color-name}-rgb), 0.08);
      }
    }

    // Preservar modificadores en tema oscuro
    &.paragraph-bold {
      font-weight: var(--font-weight-bold) !important;
    }

    &.paragraph-italic {
      font-style: italic !important;
    }

    &.paragraph-uppercase {
      text-transform: uppercase !important;
      letter-spacing: 0.05em !important;
    }
  }
}
