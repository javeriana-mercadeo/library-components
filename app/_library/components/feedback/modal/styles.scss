@use '@styles/autoload' as *;

// ============================================
// MODAL COMPONENT - Sistema de modales reutilizables
// ============================================

// Variables locales SCSS del componente
$modal-overlay-bg-opacity: 0.65;
$modal-overlay-bg-edit-opacity: 0.3;
$modal-overlay-blur: 10px;
$modal-z-index: 10001;
$modal-close-btn-z-index: 10002;
$modal-close-btn-size: 35px;
$modal-close-btn-size-tablet: 40px;
$modal-animation-offset: -16px;
$modal-timing-function: cubic-bezier(0.2, 0, 0.2, 1);

@mixin modal {

  // ==========================================
  // OVERLAY DEL MODAL
  // ==========================================
  .modal-overlay {
    box-sizing: border-box;
    position: fixed;
    inset: 0;
    display: none;
    justify-content: center;
    align-items: center;
    padding: 0;
    background-color: rgba(var(--neutral-100-rgb), $modal-overlay-bg-opacity);
    backdrop-filter: blur($modal-overlay-blur);
    box-shadow: var(--shadow-md);
    z-index: $modal-z-index;
    opacity: 0;
    transition: opacity var(--transition) $modal-timing-function;

    &.active {
      opacity: 1;

      .modal-content {
        transform: translateY(0);
        opacity: 1;
      }
    }

    &.modal-overlay-top {
      align-items: flex-start;

      @include responsive($breakpoint-sm) {
        padding-top: var(--spacing-2xl);
      }
    }

    @include responsive($breakpoint-sm) {
      padding: var(--spacing-md);
    }

    @include liferay-edit-mode {
      position: initial !important;
      display: flex !important;
      opacity: 1 !important;
      transform: none !important;
      background-color: rgba(var(--neutral-100-rgb), $modal-overlay-bg-edit-opacity);
    }
  }

  // ==========================================
  // CONTENIDO DEL MODAL
  // ==========================================
  .modal-content {
    box-sizing: border-box;
    position: relative;
    width: 100%;
    max-width: 100vw;
    max-height: 100vh;
    overflow-y: auto;
    border-radius: 0;
    background-color: var(--neutral-1000);
    color: var(--neutral-100);
    box-shadow: var(--shadow-lg);
    transform: translateY($modal-animation-offset);
    opacity: 0;
    transition:
      transform var(--transition) $modal-timing-function,
      opacity var(--transition) $modal-timing-function;

    @include responsive($breakpoint-sm) {
      max-width: 600px;
      max-height: 90vh;
      border-radius: var(--border-radius-xl);
    }

    @include responsive($breakpoint-md) {
      border-radius: var(--border-radius-xl);
    }

    // Variantes de tamaño
    &.modal-content-sm {
      @include responsive($breakpoint-sm) {
        max-width: 400px;
      }
    }

    &.modal-content-md {
      @include responsive($breakpoint-sm) {
        max-width: 600px;
      }
    }

    &.modal-content-lg {
      @include responsive($breakpoint-sm) {
        max-width: 900px;
      }
    }

    &.modal-content-xl {
      @include responsive($breakpoint-sm) {
        max-width: 1200px;
      }
    }

    &.modal-content-full {
      max-width: 95vw;
      max-height: 95vh;
    }

    @include liferay-edit-mode {
      opacity: 1 !important;
      transform: none !important;
      position: relative !important;
    }

    @include dark-theme {
      background-color: var(--neutral-900);
      color: var(--neutral-200);
    }
  }

  // ==========================================
  // BOTÓN DE CERRAR
  // ==========================================
  .modal-close-btn {
    position: absolute;
    top: var(--spacing-sm);
    right: var(--spacing-sm);
    width: $modal-close-btn-size;
    height: $modal-close-btn-size;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    border: none;
    border-radius: var(--border-radius-md);
    background: var(--neutral-900);
    color: var(--neutral-200);
    font-size: var(--font-size-title);
    font-weight: var(--font-weight-bold);
    cursor: pointer;
    z-index: $modal-close-btn-z-index;
    transition: all var(--transition) ease;

    i {
      color: var(--neutral-200);
      font-size: var(--font-size-heading);
    }

    &:hover {
      color: var(--primary-500);
      background-color: var(--neutral-800);

      i {
        color: var(--primary-500);
      }
    }

    &:focus {
      outline: var(--spacing-2xs) solid var(--primary-500);
      outline-offset: var(--spacing-2xs);
    }

    @include responsive($breakpoint-sm) {
      top: var(--spacing-md);
      right: var(--spacing-md);
      width: $modal-close-btn-size-tablet;
      height: $modal-close-btn-size-tablet;
    }

    @include dark-theme {
      background: var(--neutral-800);
      color: var(--neutral-300);

      i {
        color: var(--neutral-300);
      }

      &:hover {
        background-color: var(--neutral-700);
        color: var(--primary-400);

        i {
          color: var(--primary-400);
        }
      }
    }
  }

  // ==========================================
  // CUERPO DEL MODAL
  // ==========================================
  .modal-body {
    box-sizing: border-box;
    width: 100%;
    padding: var(--spacing-xl);

    @include responsive($breakpoint-sm) {
      padding: var(--spacing-2xl);
    }

    @include responsive($breakpoint-md) {
      padding: var(--spacing-3xl);
    }
  }

  // ==========================================
  // UTILIDADES GLOBALES
  // ==========================================

  // Prevenir scroll del body cuando hay modal activo
  body:has(.modal-overlay.active) {
    overflow: hidden;
  }

  // Editable de Liferay
  .page-editor__editable {
    margin: 0;
  }
}
