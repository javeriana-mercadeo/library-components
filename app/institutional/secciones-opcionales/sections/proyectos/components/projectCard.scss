@use '@styles/autoload' as *;

@mixin project-card {
  .carousel-slide {
    position: relative;
    width: 100%;
    min-height: rem(280px);
    border-radius: var(--border-radius-lg);
    overflow: hidden;
    background: var(--neutral-900);
    box-shadow: var(--shadow-sm);
    transition:
      transform 0.3s ease,
      box-shadow 0.3s ease;
    cursor: pointer;

    &:hover {
      box-shadow: var(--shadow-lg);
    }

    &:focus-visible {
      outline: 2px solid var(--brand-primary-500);
      outline-offset: rem(4px);
    }
  }

  .slide-image {
    position: relative;
    width: 100%;
    height: 100%;
    min-height: rem(280px);
    background-size: cover;
    background-position: center;
  }

  .slide-overlay {
    position: absolute;
    inset: auto 0 0 0;
    display: flex;
    flex-direction: column;
    gap: rem(8px);
    padding: rem(24px);
    background: linear-gradient(180deg, rgba(3, 15, 38, 0) 0%, rgba(3, 15, 38, 0.85) 100%);
    transition:
      transform 0.3s ease,
      background 0.3s ease;
    transform: translateY(calc(100% - clamp(rem(64px), 12vw, rem(110px))));
  }

  .slide-title {
    margin-bottom: rem(8px);
    font-size: rem(20px);
    font-weight: var(--font-weight-bold);
    color: var(--neutral);
  }

  .slide-description {
    display: block;
    color: var(--neutral-900);
    font-size: rem(14px);
    line-height: 1.5;
    max-height: 0;
    opacity: 0;
    overflow: hidden;
    transition:
      max-height 0.3s ease,
      opacity 0.3s ease;
  }

  .carousel-slide:hover .slide-overlay,
  .carousel-slide:focus-within .slide-overlay {
    transform: translateY(0);
    background: linear-gradient(180deg, rgba(3, 15, 38, 0.1) 0%, rgba(3, 15, 38, 0.92) 100%);
  }

  .carousel-slide:hover .slide-description,
  .carousel-slide:focus-within .slide-description {
    max-height: clamp(rem(140px), 18vw, rem(240px));
    opacity: 1;
  }

  @media (max-width: 767px) {
    .slide-overlay {
      transform: none;
      background: linear-gradient(180deg, rgba(3, 15, 38, 0.35) 0%, rgba(3, 15, 38, 0.9) 100%);
    }

    .slide-description {
      max-height: rem(240px);
      opacity: 1;
    }
  }

  // ============================================
  // MODAL DEL PROYECTO
  // ============================================
  .puj-modal-overlay.project-modal .puj-modal-body {
    display: flex;
    flex-direction: column-reverse;
    gap: var(--spacing-lg);
    padding: var(--spacing-md);

    @include responsive {
      flex-direction: row;
      gap: var(--spacing-xl);
      padding: var(--spacing-lg);
    }

    // Desktop: Más espacio
    @include responsive($breakpoint-lg) {
      gap: var(--spacing-2xl);
      padding: var(--spacing-xl);
    }
  }

  // ============================================
  // GALERÍA (Izquierda en Desktop)
  // ============================================
  .project-modal__gallery {
    flex: 1 1 auto;
    display: flex;
    flex-direction: column;
    gap: var(--spacing-lg);
    min-height: rem(250px);

    @include responsive($breakpoint-md) {
      flex: 0 0 60%; // Mayor espacio para la galería
      overflow-y: auto;
      overflow-x: hidden;
      max-height: calc(80vh - var(--spacing-lg) * 2);
    }

    @include responsive($breakpoint-lg) {
      flex: 0 0 63%; // Más espacio en desktop grande
    }

    // Custom scrollbar
    &::-webkit-scrollbar {
      width: rem(6px);
    }

    &::-webkit-scrollbar-track {
      background: transparent;
    }

    &::-webkit-scrollbar-thumb {
      background: var(--brand-primary-400);
      border-radius: var(--border-radius-sm);
      transition: background var(--transition);

      &:hover {
        background: var(--brand-primary-500);
      }
    }

    scrollbar-width: thin;
    scrollbar-color: var(--brand-primary-400) transparent;

    // Media items
    .media-item {
      position: relative;
      width: 100%;
      border-radius: var(--border-radius-lg);
      overflow: hidden;
      background: var(--neutral-100);
      box-shadow: var(--shadow-sm);
      transition: box-shadow var(--transition);

      &:hover {
        box-shadow: var(--shadow-md);
      }

      &--video {
        aspect-ratio: 16 / 9;

        iframe {
          width: 100%;
          height: 100%;
          border: none;
          display: block;
        }
      }

      &--image {
        img {
          width: 100%;
          height: auto;
          display: block;
          object-fit: cover;
          max-height: rem(500px);
        }
      }
    }
  }

  // ============================================
  // INFORMACIÓN (Derecha en Desktop)
  // ============================================
  .project-modal__info {
    flex: 1 1 auto;
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
    min-width: 0;

    @include responsive($breakpoint-md) {
      flex: 0 0 40%; // Menos espacio para la info
      overflow-y: auto;
      overflow-x: hidden;
      max-height: calc(80vh - var(--spacing-lg) * 2);
    }

    @include responsive($breakpoint-lg) {
      flex: 0 0 37%; // Ajustado para complementar el 63% de la galería
      gap: var(--spacing-lg);
    }

    // Custom scrollbar
    &::-webkit-scrollbar {
      width: rem(6px);
    }

    &::-webkit-scrollbar-track {
      background: transparent;
    }

    &::-webkit-scrollbar-thumb {
      background: var(--brand-primary-400);
      border-radius: var(--border-radius-sm);
      transition: background var(--transition);

      &:hover {
        background: var(--brand-primary-500);
      }
    }

    scrollbar-width: thin;
    scrollbar-color: var(--brand-primary-400) transparent;

    // Título
    .project-modal__title {
      margin: 0;
      color: var(--neutral-100);
      line-height: 1.2;
      padding-bottom: var(--spacing-md);
      border-bottom: rem(2px) solid var(--neutral-300);
    }

    // Meta información
    .project-modal__meta {
      display: flex;
      flex-direction: column;
      gap: var(--spacing-sm);

      @include responsive($breakpoint-sm) {
        flex-direction: row;
        gap: var(--spacing-lg);
      }
    }

    .meta-item {
      color: var(--neutral-100);

      strong {
        color: var(--neutral-700);
        font-weight: var(--font-weight-semibold);
        text-transform: uppercase;
        font-size: var(--font-size-xs);
        letter-spacing: 0.5px;
      }
    }

    // Descripción
    .project-modal__description {
      padding-top: var(--spacing-md);
      border-top: rem(1px) solid var(--neutral-300);
      line-height: 1.6;
      color: var(--neutral-800);

      p {
        margin: 0 0 var(--spacing-md) 0;

        &:last-child {
          margin-bottom: 0;
        }
      }

      strong,
      b {
        font-weight: var(--font-weight-bold);
        color: var(--neutral-100);
      }

      a {
        color: var(--brand-primary-500);
        text-decoration: underline;
        transition: color var(--transition);

        &:hover {
          color: var(--brand-primary-600);
        }
      }

      ul,
      ol {
        padding-left: var(--spacing-lg);
        margin: var(--spacing-sm) 0;

        li {
          margin-bottom: var(--spacing-xs);
        }
      }
    }
  }

  // ============================================
  // RESPONSIVE: Mejoras móviles
  // ============================================
  @media (max-width: 767px) {
    .puj-modal-overlay.project-modal .puj-modal-body {
      padding: var(--spacing-sm);
      gap: var(--spacing-md);
    }

    .project-modal__gallery {
      min-height: rem(200px);
    }

    .project-modal__info .project-modal__title {
      font-size: var(--font-size-lg);
    }
  }
}
