@use '@styles/autoload' as *;

:root {

  --javeriana-acc-menu-bg-dark: var(--neutral-400);
  --javeriana-acc-menu-text: #cbd5e0;
  --javeriana-acc-menu-hover: #4866d1;
  --javeriana-acc-whatsapp: #25d366;
  --javeriana-acc-bg-light: #ffffff;
  --javeriana-acc-bg-dark: #1a1a1a;
  --javeriana-acc-text-light: #2d3748;
  --javeriana-acc-text-dark: #f7fafc;
  --javeriana-acc-border-light: #e2e8f0;
  --javeriana-acc-border-dark: #4a5568;
  --javeriana-acc-z-menu: 999999;
  --javeriana-acc-z-whatsapp: 999998;
  --javeriana-acc-z-modal: 999997;
  --javeriana-acc-transition: all 0.3s ease;
  --accessibility-font-scale: 1;
}

/* ===================================================================
   PROTECCIÓN ABSOLUTA CONTRA ZOOM Y FILTROS - MEJORADA
   =================================================================== */

/* Protección total para elementos de accesibilidad */
.floating-menu,
.floating-menu *,
.whatsapp-floating-button,
.whatsapp-floating-button *,
.share-modal-overlay,
.share-modal-overlay *,
.share-modal,
.share-modal *,
[class*="accessibility"],
[id*="accessibility"] {
  filter: none !important;
  -webkit-filter: none !important;
  visibility: visible !important;
  opacity: 1 !important;
  transform: none !important;
  zoom: 1 !important;
  font-size: initial !important;
  scale: 1 !important;
  -webkit-transform: none !important;
  -moz-transform: none !important;
  -ms-transform: none !important;
  -o-transform: none !important;
}

/* ===================================================================
   ESCALA DE GRISES CORREGIDA - SELECTORES MÁS ESPECÍFICOS
   =================================================================== */

/* Aplicar escala de grises SOLO a elementos específicos del contenido */
#wrapper.grayscale-mode ,
body.grayscale-mode .portlet-boundary,
body.grayscale-mode .portlet-content,
body.grayscale-mode .journal-content-article,
body.grayscale-mode .portlet-body,
body.grayscale-mode main,
body.grayscale-mode .container-fluid:not(.floating-menu):not(.whatsapp-floating-button),
body.grayscale-mode .container:not(.floating-menu):not(.whatsapp-floating-button),
body.grayscale-mode .content,
body.grayscale-mode .main-content,
body.grayscale-mode .page-content,
body.grayscale-mode section,
body.grayscale-mode article,
body.grayscale-mode .card,
body.grayscale-mode .row,
body.grayscale-mode .col {
  filter: grayscale(100%) !important;
  transition: filter 0.3s ease !important;
}

/* Aplicar escala de grises a imágenes y videos específicos */
body.grayscale-mode img:not(.floating-menu img):not(.whatsapp-floating-button img):not(.share-modal img):not([class*="accessibility"]),
body.grayscale-mode video:not(.floating-menu video):not(.whatsapp-floating-button video):not(.share-modal video):not([class*="accessibility"]) {
  filter: grayscale(100%) !important;
  transition: filter 0.3s ease !important;
}

/* PROTECCIÓN REFORZADA - Múltiples niveles de especificidad */
html body.grayscale-mode .floating-menu,
html body.grayscale-mode .floating-menu *,
html body.grayscale-mode .whatsapp-floating-button,
html body.grayscale-mode .whatsapp-floating-button *,
html body.grayscale-mode .share-modal-overlay,
html body.grayscale-mode .share-modal-overlay *,
html body.grayscale-mode .share-modal,
html body.grayscale-mode .share-modal *,
html body.grayscale-mode [class*="accessibility"],
html body.grayscale-mode [id*="accessibility"] {
  filter: none !important;
  -webkit-filter: none !important;
  visibility: visible !important;
  opacity: 1 !important;
  display: flex !important;
}

/* Protección con especificidad máxima */
body.grayscale-mode .floating-menu,
body.grayscale-mode .floating-menu .menu-item,
body.grayscale-mode .floating-menu .menu-item *,
body.grayscale-mode .whatsapp-floating-button,
body.grayscale-mode .whatsapp-floating-button .menu-item,
body.grayscale-mode .whatsapp-floating-button .menu-item * {
  filter: none !important;
  -webkit-filter: none !important;
  visibility: visible !important;
  opacity: 1 !important;
  transform: none !important;
  display: flex !important;
}

/* ===================================================================
   MENÚ FLOTANTE PRINCIPAL
   =================================================================== */
.floating-menu {
   position: fixed !important;
  z-index: 999999 !important;
  top: 142px;
  left: 10px;
  width: 42px !important;
  height: auto !important;
  min-height: 253px !important;
  background-color: var(--neutral-900) !important;
  border-radius: 20px !important;
  z-index: var(--javeriana-acc-z-menu) !important;
  padding: 10px 0 !important;
  margin: 0 !important;
  display: flex !important;
  flex-direction: column !important;
  justify-content: space-between !important;
  align-items: center !important;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25) !important;
  transition: var(--javeriana-acc-transition) !important;
  font-family: system-ui, -apple-system, sans-serif !important;
  box-sizing: border-box !important;
  user-select: none !important;
  visibility: visible !important;
  opacity: 1 !important;
  
  /* Protección específica contra filtros */
  filter: none !important;
  -webkit-filter: none !important;
  transform: none !important;
  scale: 1 !important;
  zoom: 1 !important;
  font-size: initial !important;

  /* Animación de entrada */
  animation: fadeInAccessibility 0.5s ease-out !important;
}

/* Estado tema oscuro */
body.accessibility-dark-theme .floating-menu {
  background-color: var(--neutral-900) !important;
  opacity: 1 !important;
}

/* ===================================================================
   BOTÓN DE WHATSAPP
   =================================================================== */
.whatsapp-floating-button {
  position: fixed !important;
  top: 415px !important;
  left: 10px !important;
  width: 42px !important;
  height: 42px !important;
  background-color: var(--javeriana-acc-whatsapp) !important;
  border-radius: 50% !important;
  z-index: var(--javeriana-acc-z-whatsapp) !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  box-shadow: 0 4px 12px rgba(37, 211, 102, 0.4) !important;
  transition: var(--javeriana-acc-transition) !important;
  cursor: pointer !important;
  visibility: visible !important;
  opacity: 1 !important;
  margin: 0 !important;
  padding: 0 !important;
  box-sizing: border-box !important;
  
  /* Protección específica */
  filter: none !important;
  -webkit-filter: none !important;
  transform: none !important;
  scale: 1 !important;
  zoom: 1 !important;
  font-size: initial !important;

  &:hover {
    transform: scale(1.05) !important;
    box-shadow: 0 6px 20px rgba(37, 211, 102, 0.5) !important;
  }
}

/* ===================================================================
   ITEMS DEL MENÚ
   =================================================================== */
.menu-item {
  position: relative !important;
  width: 35px !important;
  height: 35px !important;
  border-radius: 50% !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  cursor: pointer !important;
  overflow: hidden !important;
  margin: 2px 0 !important;
  padding: 0 !important;
  background: transparent !important;
  border: none !important;
  transition: var(--javeriana-acc-transition) !important;
  user-select: none !important;
  
  /* Protección específica */
  filter: none !important;
  -webkit-filter: none !important;
  transform: none !important;
  scale: 1 !important;
  zoom: 1 !important;
  font-size: initial !important;
  visibility: visible !important;
  opacity: 1 !important;

  /* Elemento para efecto hover */
  span {
    position: absolute !important;
    top: 50% !important;
    left: 50% !important;
    width: 0 !important;
    height: 0 !important;
    border-radius: 50% !important;
    transform: translate(-50%, -50%) !important;
    transition: var(--javeriana-acc-transition) !important;
    z-index: 0 !important;
    background-color: transparent !important;
    pointer-events: none !important;
    filter: none !important;
    -webkit-filter: none !important;
  }

  /* Iconos */
  i {
    font-size: 22px !important;
    color: var(--javeriana-acc-menu-text) !important;
    transition: var(--javeriana-acc-transition) !important;
    z-index: 1 !important;
    position: relative !important;
    line-height: 1 !important;
    margin: 0 !important;
    padding: 0 !important;
    filter: none !important;
    -webkit-filter: none !important;
  }

  /* Iconos en tema oscuro */
  .accessibility-dark-theme & i {
    color: #2d3748 !important;
  }
  
  /* Efectos hover para elementos regulares */
  &:hover:not(.whatsapp-button) {
    span {
      width: 3.6rem !important;
      height: 3.6rem !important;
      background-color: var(--javeriana-acc-menu-hover) !important;
      transform: translate(-50%, -50%) scale(1) !important;
    }
    
    i {
      color: white !important;
      transform: scale(1.1) !important;
    }
  }
  
  /* Colores específicos por función */
  &:nth-child(1):hover:not(.whatsapp-button) span { 
    background-color: #10b981 !important; /* Aumentar fuente - Verde */
  }
  
  &:nth-child(2):hover:not(.whatsapp-button) span { 
    background-color: #ef4444 !important; /* Disminuir fuente - Rojo */
  }
  
  &:nth-child(3):hover:not(.whatsapp-button) span { 
    background-color: #ffd93d !important; /* Tema - Amarillo */
  }
  
  &:nth-child(4):hover:not(.whatsapp-button) span { 
    background-color: #9ca3af !important; /* Escala de grises - Gris */
  }
  
  &:nth-child(5):hover:not(.whatsapp-button) span { 
    background-color: #4caf50 !important; /* Compartir - Verde */
  }
  
  /* Estados activos */
  &.active {
    span {
      width: 3.6rem !important;
      height: 3.6rem !important;
      background-color: var(--javeriana-acc-menu-hover) !important;
      transform: translate(-50%, -50%) scale(1) !important;
    }
    
    i {
      color: #ffd93d !important;
      transform: scale(1.1) !important;
    }
  }
  
  /* Estilos para botón de WhatsApp */
  &.whatsapp-button {
    width: 42px !important;
    height: 42px !important;
    background: transparent !important;
    
    i {
      font-size: 22px !important;
      color: white !important;
      position: absolute !important;
      top: 50% !important;
      left: 50% !important;
      transform: translate(-50%, -50%) !important;
      line-height: 1 !important;
      margin: 0 !important;
      padding: 0 !important;
      display: block !important;
      text-align: center !important;
    }
    
    &:hover {
      span {
        width: 3.6rem !important;
        height: 3.6rem !important;
        background-color: rgba(255, 255, 255, 0.2) !important;
        transform: translate(-50%, -50%) scale(1) !important;
      }
      
      i {
        color: white !important;
        transform: translate(-50%, -50%) scale(1.1) !important;
      }
    }
  }
}

/* ===================================================================
   ESTADO ACTIVO DEL BOTÓN DE ESCALA DE GRISES - CORREGIDO
   =================================================================== */

/* Botón de escala de grises en estado activo */
.menu-item[data-action="grayscale"].active {
  span {
    width: 3.6rem !important;
    height: 3.6rem !important;
    background-color: #9ca3af !important;
    transform: translate(-50%, -50%) scale(1) !important;
  }
  
  i {
    color: white !important;
    transform: scale(1.1) !important;
  }
}

/* Indicador visual cuando escala de grises está activa */
body.grayscale-mode .menu-item[data-action="grayscale"] {
  &::after {
    content: '';
    position: absolute;
    top: -2px;
    right: -2px;
    width: 8px;
    height: 8px;
    background-color: #9ca3af;
    border-radius: 50%;
    border: 2px solid white;
    z-index: 10;
    filter: none !important;
    -webkit-filter: none !important;
  }
}

/* Hover para escala de grises */
.menu-item[data-action="grayscale"]:hover:not(.whatsapp-button) {
  span {
    width: 3.6rem !important;
    height: 3.6rem !important;
    background-color: #9ca3af !important;
    transform: translate(-50%, -50%) scale(1) !important;
  }
  
  i {
    color: white !important;
    transform: scale(1.1) !important;
  }
}

/* ===================================================================
   MODAL DE COMPARTIR
   =================================================================== */
.share-modal-overlay {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  width: 100vw !important;
  height: 100vh !important;
  background-color: rgba(0, 0, 0, 0.6) !important;
  z-index: var(--javeriana-acc-z-modal) !important;
  display: none !important;
  align-items: center !important;
  justify-content: center !important;
  opacity: 0 !important;
  transition: opacity 0.3s ease !important;
  padding: 20px !important;
  box-sizing: border-box !important;
  
  /* Protección específica */
  filter: none !important;
  -webkit-filter: none !important;
  transform: none !important;
  scale: 1 !important;
  zoom: 1 !important;
  font-size: initial !important;
  
  &.show {
    display: flex !important;
    opacity: 1 !important;
  }
}

.share-modal {
  background: var(--javeriana-acc-bg-light) !important;
  border-radius: 16px !important;
  width: 100% !important;
  max-width: 400px !important;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3) !important;
  overflow: hidden !important;
  transform: scale(0.9) !important;
  transition: transform 0.3s ease !important;
  margin: 0 !important;
  padding: 0 !important;
  position: relative !important;
  opacity: 1 !important;
  
  /* Protección específica */
  filter: none !important;
  -webkit-filter: none !important;
  font-size: initial !important;
  zoom: 1 !important;
  
  .show & {
    transform: scale(1) !important;
  }
}

/* ===================================================================
   PROTECCIÓN FINAL REFORZADA
   =================================================================== */

/* Protección de último recurso con máxima especificidad */
html body.grayscale-mode .floating-menu,
html body.grayscale-mode .floating-menu *,
html body.grayscale-mode .whatsapp-floating-button,
html body.grayscale-mode .whatsapp-floating-button *,
html body.grayscale-mode .share-modal-overlay,
html body.grayscale-mode .share-modal-overlay *,
html body.grayscale-mode .share-modal,
html body.grayscale-mode .share-modal *,
html body.grayscale-mode [class*="accessibility"],
html body.grayscale-mode [id*="accessibility"] {
  filter: none !important;
  -webkit-filter: none !important;
  visibility: visible !important;
  opacity: 1 !important;
  display: flex !important;
  transform: none !important;
  zoom: 1 !important;
  font-size: initial !important;
  scale: 1 !important;
  -webkit-transform: none !important;
  -moz-transform: none !important;
  -ms-transform: none !important;
  -o-transform: none !important;
}

/* Protección específica para el contenedor del menú */
.floating-menu {
  filter: none !important;
  -webkit-filter: none !important;
  visibility: visible !important;
  opacity: 1 !important;
  display: flex !important;
}

/* Protección específica para cuando se activa escala de grises */
body.grayscale-mode .floating-menu {
  filter: none !important;
  -webkit-filter: none !important;
  visibility: visible !important;
  opacity: 1 !important;
  display: flex !important;
  background-color: var(--neutral-900) !important;
}

/* ===================================================================
   ANIMACIONES Y RESPONSIVE
   =================================================================== */

@keyframes fadeInAccessibility {
  from {
    opacity: 0;
    transform: translateX(-20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

/* Responsive Design */
@media (max-width: 768px) {
  .floating-menu {
    top: 20px !important;
    width: 38px !important;
    min-height: 203px !important;
    padding: 8px 0 !important;
  }

  .whatsapp-floating-button {
    top: 243px !important;
    width: 38px !important;
    height: 38px !important;
  }

  .menu-item {
    width: 32px !important;
    height: 32px !important;
    
    i {
      font-size: 20px !important;
    }
    
    &.whatsapp-button {
      width: 38px !important;
      height: 38px !important;
      
      i {
        font-size: 20px !important;
      }
    }
  }
}

@media (max-width: 480px) {
  .floating-menu {
    top: 15px !important;
    left: 5px !important;
    width: 36px !important;
    min-height: 165px !important;
  }

  .whatsapp-floating-button {
    top: 200px !important;
    left: 5px !important;
    width: 36px !important;
    height: 36px !important;
  }

  .menu-item {
    width: 30px !important;
    height: 30px !important;
    
    i {
      font-size: 18px !important;
    }
    
    &.whatsapp-button {
      width: 36px !important;
      height: 36px !important;
      
      i {
        font-size: 18px !important;
      }
    }
  }
}